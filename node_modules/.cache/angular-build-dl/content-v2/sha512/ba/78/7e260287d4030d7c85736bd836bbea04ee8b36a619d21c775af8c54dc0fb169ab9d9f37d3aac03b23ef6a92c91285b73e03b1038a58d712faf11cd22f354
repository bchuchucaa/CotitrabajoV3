{"version":3,"sources":["webpack:///src/app/components/crear-obra/crear-obra.page.html","webpack:///src/app/components/take-photo/take-photo.component.html","webpack:///src/app/components/crear-obra/crear-obra-routing.module.ts","webpack:///src/app/components/crear-obra/crear-obra.module.ts","webpack:///src/app/components/crear-obra/crear-obra.page.scss","webpack:///src/app/components/crear-obra/crear-obra.page.ts","webpack:///src/app/components/take-photo/take-photo.component.scss","webpack:///src/app/components/take-photo/take-photo.component.ts"],"names":["routes","path","component","CrearObraPageRoutingModule","imports","forChild","exports","CrearObraPageModule","forRoot","apiKey","declarations","CrearObraPage","camera","storage","database","route","router","obraService","notificacionesService","locationService","current","latitude","longitude","address","newLocation","title","lat","lng","obra","uidCliente","localStorage","getItem","console","log","isUploaded","isUploading","imageCollection","collection","images","valueChanges","getCurrentLocation","verificarSesion","codigocliente","longitud","image","saveObra","navigationExtras","queryParams","notificacionToast","url","navigate","error","event","file","item","type","split","fileName","name","Date","getTime","customMetadata","app","fileRef","ref","task","upload","percentaje","percentageChanges","snapshot","snapshotChanges","pipe","UploadedFileURL","getDownloadURL","subscribe","resp","addImagetoDB","filepath","size","fileSize","snap","totalBytes","id","createId","doc","set","then","options","quality","destinationType","DestinationType","FILE_URI","encodingType","EncodingType","JPEG","mediaType","MediaType","PICTURE","getPicture","imageData","base64Image","err","data","imgData","getAddressOfLocation","selector","template","TakePhotoComponent","loadingCtrl","source","imageSelected","uploadFinished","DATA_URL","sourceType","PictureSourceType","CAMERA","startUpload","PHOTOLIBRARY","emit","byteCharacters","atob","Number","length","putString","create","message","loading","present","val","complete","setTimeout","dismiss","downloadURL","JSON","stringify","sizeInBytes","units","power","Math","round","min","pow","formattedSize","unit"],"mappings":"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","file":"components-crear-obra-crear-obra-module-es5.js","sourcesContent":["export default \"<!-- Large title -->\\n<ion-header [translucent]=\\\"true\\\">\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-menu-button></ion-menu-button>\\n        </ion-buttons>\\n\\n        <ion-title> PUBLICAR OBRA</ion-title>\\n        <ion-avatar slot=\\\"start\\\">\\n            <img src=\\\"assets/icon/iconlogo.png\\\" alt=\\\" Ionic logo \\\">\\n        </ion-avatar>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<!--<ion-button (click)=\\\"tomarFoto() \\\" color=\\\" success \\\">Fotografia</ion-button>-->\\n\\n\\n<ion-content>\\n\\n    <ion-card>\\n        <div class=\\\"login-logo \\\">\\n            <img src=\\\"assets/img/publica.jpg \\\" alt=\\\"Ionic logo \\\">\\n        </div>\\n        <ion-card-header>Datos de tu obra</ion-card-header>\\n        <ion-item>\\n            <ion-input placeholder=\\\"Ingresa un titulo \\\" [(ngModel)]=\\\"obra.titulo \\\">Titulo: </ion-input>\\n        </ion-item>\\n        <ion-item>\\n            <ion-textarea placeholder=\\\"Ingresa una descripcion de tu obra \\\" [(ngModel)]=\\\"obra.descripcion \\\">Descipcion: </ion-textarea>\\n        </ion-item>\\n        <ion-item>\\n            <ion-label>Selecciona una categoria</ion-label>\\n            <ion-select class=\\\"custom-options \\\" [(ngModel)]=\\\"obra.categoria \\\">\\n                <ion-select-option value=\\\"CARPINTERIA \\\">CARPINTERIA</ion-select-option>\\n                <ion-select-option value=\\\"INDUSTRIAL \\\">INDUSTRIAL</ion-select-option>\\n                <ion-select-option value=\\\"PLOMERIA \\\">PLOMERIA</ion-select-option>\\n                <ion-select-option value=\\\"ARQUITECTURA \\\">ARQUITECTURA</ion-select-option>\\n            </ion-select>\\n\\n\\n\\n        </ion-item>\\n        <ion-item>\\n            <ion-label>Sube una fotografia</ion-label>\\n            <app-take-photo [source]=\\\" 'gallery' \\\" (imageSelected)=\\\"imageSeleccionada($event) \\\" (uploadFinished)=\\\"uploadFinished($event) \\\"></app-take-photo>\\n\\n        </ion-item>\\n    </ion-card>\\n    <!--<app-take-photo [source]=\\\" 'photo' \\\" (imageSelected)=\\\"imageSeleccionada($event) \\\" (uploadFinished)=\\\"uploadFinished($event) \\\"></app-take-photo>\\n    -->\\n\\n    <ion-card *ngIf=\\\"obra.image \\\">\\n        <ion-img [src]=\\\"imgData \\\"></ion-img>\\n        <ion-img [src]=\\\"obra.image?.url \\\"></ion-img>\\n    </ion-card>\\n\\n    <div style=\\\"margin: 5%;margin-left: 20%; \\\">\\n        <ion-button (click)=\\\"guardarObra() \\\" color=\\\"success \\\">Publicar\\n            <ion-icon name=\\\"checkmark-done-circle-outline \\\"></ion-icon>\\n        </ion-button>\\n        <ion-button color=\\\"danger \\\">Cancelar\\n            <ion-icon name=\\\"trash-outline \\\"></ion-icon>\\n        </ion-button>\\n    </div>\\n    <agm-map [latitude]=\\\"lat\\\" [longitude]=\\\"lng\\\" (centerChange)=\\\"setNewLocation($event)\\\">\\n        <agm-marker [latitude]=\\\"lat\\\" [longitude]=\\\"lng\\\" [iconUrl]=\\\"'https://cdn4.iconfinder.com/data/icons/essential-app-2/16/botton-on-launch-point-48.png'\\\">\\n            <agm-info-window>UPS</agm-info-window>\\n\\n        </agm-marker>\\n\\n\\n        <agm-marker [latitude]=\\\"current.latitude\\\" [longitude]=\\\"current.longitude\\\" [iconUrl]=\\\"'https://cdn4.iconfinder.com/data/icons/essential-app-2/16/botton-on-launch-point-48.png'\\\">\\n            <agm-info-window>{{current.address}}</agm-info-window>\\n\\n        </agm-marker>\\n\\n        <agm-marker [latitude]=\\\"newLocation.latitude\\\" [longitude]=\\\"newLocation.longitude\\\" [iconUrl]=\\\"'https://cdn2.iconfinder.com/data/icons/pointers-5/24/pointer-top-left-48.png'\\\">\\n            <agm-info-window>{{newLocation.address}}</agm-info-window>\\n\\n        </agm-marker>\\n\\n\\n\\n\\n    </agm-map>\\n\\n</ion-content>\";","export default \"<ion-button color=\\\"dark\\\" (click)=\\\"tomarFoto()\\\" *ngIf=\\\"source=='photo'\\\">\\n    <ion-icon name=\\\"camera-outline\\\"></ion-icon> Fotografia\\n</ion-button>\\n<ion-button color=\\\"dark\\\" icon=\\\"image-outline\\\" (click)=\\\"recuperarImgagen()\\\" *ngIf=\\\"source!=='photo'\\\">\\n    <ion-icon name=\\\"image-outline\\\"></ion-icon> Galeria\\n</ion-button>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CrearObraPage } from './crear-obra.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CrearObraPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CrearObraPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { TakePhotoComponent } from '../take-photo/take-photo.component';\n\nimport { CrearObraPageRoutingModule } from './crear-obra-routing.module';\n\nimport { CrearObraPage } from './crear-obra.page';\nimport { AgmCoreModule } from '@agm/core';\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CrearObraPageRoutingModule,\n    AgmCoreModule.forRoot({\n      apiKey: 'AIzaSyC7lREbDALML3-f6Nj0lEwoFTMuWcmZdK4'\n    })\n  ],\n  declarations: [CrearObraPage,TakePhotoComponent]\n})\nexport class CrearObraPageModule {}\n","export default \"agm-map {\\n  height: 300px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50cy9jcmVhci1vYnJhL2NyZWFyLW9icmEucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtBQUNKIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50cy9jcmVhci1vYnJhL2NyZWFyLW9icmEucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiYWdtLW1hcCB7XG4gICAgaGVpZ2h0OiAzMDBweDtcbn0iXX0= */\";","import { Component, OnInit } from '@angular/core';\nimport { Obra } from '../../model/obra';\nimport { ActivatedRoute, NavigationExtras, Router } from '@angular/router';\nimport { ObrasService } from '../../services/obras.service';\nimport { NotificacionesService } from '../../services/notificaciones.service';\n//IMPORT TO UPLOAD IMAGES BY SCORPION\nimport { AngularFirestore, AngularFirestoreCollection } from '@angular/fire/firestore';\nimport { AngularFireStorage, AngularFireUploadTask } from '@angular/fire/storage';\nimport { Observable } from 'rxjs';\nimport { finalize, tap } from 'rxjs/operators';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport { LocationService } from '../../services/location.service';\nimport { Localizacion } from '../../model/localizacion';\nexport interface MyData {\n  name: string;\n  filepath: string;\n  size: number;\n}\n\n\n\n@Component({\n  selector: 'app-crear-obra',\n  templateUrl: './crear-obra.page.html',\n  styleUrls: ['./crear-obra.page.scss'],\n})\nexport class CrearObraPage implements OnInit {\n  task: AngularFireUploadTask;\n  percentaje: Observable<number>;\n  snapshot: Observable<any>;\n  UploadedFileURL: Observable<string>;\n  images: Observable<MyData[]>;\n  fileName:string;\n  fileSize:number;\n  isUploading:boolean;\n  isUploaded:boolean;\n\n  imgData: string;\n  imgURL: string;\n  //PARA EL MAPA\n  current = {\n    latitude: '',\n    longitude: '',\n    address: ''\n  }\n\n  newLocation = {\n    latitude: '',\n    longitude: '',\n    address: ''\n  }\n  title = 'My first AGM project';\n  lat = 51.678418;\n  lng = 7.809007;\n\n  private imageCollection: AngularFirestoreCollection<MyData>;\n\n  uidCliente:string;\n  idImgObra:string;\n\n  obra :Obra =new Obra();\n  constructor(private camera:Camera,private storage:AngularFireStorage,private database:AngularFirestore, private route: ActivatedRoute, private router: Router,public obraService:ObrasService,public notificacionesService: NotificacionesService,private locationService: LocationService) { \n    this.uidCliente=localStorage.getItem(\"uid\")\n    console.log(\"consultando \", this.uidCliente);\n    obraService:ObrasService;\n    this.isUploaded=false;\n    this.isUploading=false;\n    this.imageCollection = database.collection<MyData>('freakyImages');\n    this.images = this.imageCollection.valueChanges();\n\n  }\n\n  async ngOnInit() {\n    this.current = await this.locationService.getCurrentLocation();\n   \n  }\n\n  guardarObra(){\n    console.log(this.uidCliente);\n    this.verificarSesion();\n  \n    try{\n      this.obra.codigocliente=this.uidCliente;\n      this.obra.latitude=this.current.latitude;\n      this.obra.longitud=this.current.longitude;\n      this.obra.address=this.current.address;\n      console.log(this.obra.image);\n      this.obraService.saveObra(this.obra);\n    \n      let navigationExtras: NavigationExtras ={\n        queryParams:{\n          obra: this.obra,\n        }\n      };\n      this.notificacionesService.notificacionToast(\"Tu obra se creo correctamente..!  :)\");\n      const url='/view-cliente/'+this.uidCliente;\n      console.log('Sending this route '+url);\n      this.router.navigate([url]);\n    }catch(error){\n      console.error(\"Error tratando de guardar la obra\", error);\n      throw error;\n    \n    }\n  }\n  subirImagen(event:FileList)\n  {\n    const file= event.item(0);\n    if (file.type.split('/')[0]!=='image'){\n      console.log(\"Error formato desconocido :(\")\n      return;\n    }\n    this.isUploading=true;\n    this.isUploaded=false;\n    this.fileName=file.name;\n    const path =`freakyStorage/${new Date().getTime()}_${file.name}`;\n    const customMetadata = {app:'Freaky Image Upload Demo'};\n    const fileRef= this.storage.ref(path);\n    console.log(path);\n    this.task = this.storage.upload(path,file,{customMetadata});\n    console.log(path,file,{customMetadata});\n    this.percentaje = this.task.percentageChanges();\n    this.snapshot=  this.task.snapshotChanges().pipe(\n      finalize(() => {\n        this.UploadedFileURL = fileRef.getDownloadURL();\n        console.log(\"ruta imagen subir \"+this.UploadedFileURL);\n        this.UploadedFileURL.subscribe(resp=>{\n          this.addImagetoDB({\n            name:file.name,\n            filepath:resp,\n            size:this.fileSize,        \n           \n\n          });\n          this.isUploading=false;\n          this.isUploaded =true;\n\n        },error =>{\n          console.error(error);\n        })\n      }),\n      tap(snap=>{\n        this.fileSize = snap.totalBytes;\n      })\n    )\n\n  }\n\n  addImagetoDB(image: MyData) {\n    //Create an ID for document\n    const id = this.database.createId();\n  \n    //Set document id with value in database\n    this.imageCollection.doc(id).set(image).then(resp => {\n      console.log(resp);\n    }).catch(error => {\n      console.log(\"error \" + error);\n    });\n  }\n  tomarFoto(){\n    const options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.FILE_URI,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE\n    }\n    \n    this.camera.getPicture(options).then((imageData) => {\n     // imageData is either a base64 encoded string or a file URI\n     // If it's base64 (DATA_URL):\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     console.log(base64Image);\n    }, (err) => {\n     // Handle error\n    });\n  }\n  imageSeleccionada(data){\n    console.log(\"subiendo data imagen\");\n    console.log(data);\n    this.imgData = data;\n  }\n\n  uploadFinished(data){\n    console.log(\"upload finished\");\n    this.obra.image = data;\n    console.log(this.obra.image);\n    console.log(\"-----------------\");\n  }\n  verificarSesion(){\n    if(this.uidCliente==null || this.uidCliente==\"\"){\n      this.router.navigate(['log-in']);\n    }\n    \n  }\n  //para el mapa\n \n  setNewLocation(event) {\n    if (event) {\n      this.newLocation.latitude = event.lat;\n      this.newLocation.longitude = event.lng;\n      this.locationService.getAddressOfLocation(this.newLocation);\n    }\n  }\n  \n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudHMvdGFrZS1waG90by90YWtlLXBob3RvLmNvbXBvbmVudC5zY3NzIn0= */\";","import { Component, Input, OnInit, Output } from '@angular/core';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport { EventEmitter } from '@angular/core'\nimport { AngularFireStorage } from '@angular/fire/storage';\nimport { LoadingController } from '@ionic/angular';\nimport { filter, finalize, tap } from 'rxjs/operators'\n\n\n@Component({\n  selector: 'app-take-photo',\n  templateUrl: './take-photo.component.html',\n  styleUrls: ['./take-photo.component.scss'],\n})\nexport class TakePhotoComponent implements OnInit {\n\n  @Input() source: string = 'photo';   //posibilidades: photo, gallery\n\n  imageData: string;\n\n  @Output() imageSelected = new EventEmitter<any>();\n  @Output() uploadFinished = new EventEmitter<any>();\n\n  constructor(private camera: Camera,\n      private storage: AngularFireStorage,\n      private loadingCtrl: LoadingController) { }\n\n  ngOnInit() {}\n\n  tomarFoto(){\n    const options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      sourceType: this.camera.PictureSourceType.CAMERA\n    }\n    \n    this.camera.getPicture(options).then((imageData) => {\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n     this.startUpload(imageData);\n    }, (err) => {\n     // Handle error\n    });\n  }\n\n  recuperarImgagen(){\n    const options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      sourceType: this.camera.PictureSourceType.PHOTOLIBRARY\n    }\n    \n    this.camera.getPicture(options).then((imageData) => {\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n     this.startUpload(imageData);\n     this.imageSelected.emit(base64Image);\n    }, (err) => {\n     // Handle error\n    });\n  }\n\n  async startUpload(file: string){\n    let byteCharacters = atob(file);\n    \n    const path = `images/${new Date().getTime()}.jpg`;\n   \n    let image = 'data:image/jpg;base64,'+file;\n    \n    const data = {\n      ref: path,\n      type: 'image',\n      url: null,\n      name: 'image',\n      size: this.fileSize(Number(byteCharacters.length))\n    }\n\n    try{\n      let ref = this.storage.ref(path);\n      let task = ref.putString(image, 'data_url');\n      const loading = await this.loadingCtrl.create({\n        message: 'Espere, subiendo fotografía...'\n      });  \n      await loading.present(); \n\n      //Listener de progreso de carga\n      task.percentageChanges().pipe(\n        filter(val => val === 100),\n        tap(complete => {\n          setTimeout(() => {\n            loading.dismiss();\n          }, 3500);\n        })\n      ).subscribe();\n\n      task.snapshotChanges().pipe(\n        finalize(() => {\n            let downloadURL = ref.getDownloadURL()\n            downloadURL.subscribe(url => {\n              data.url= url;\n              console.log(\"donload terminado \" + url);\n              this.uploadFinished.emit(data);\n            });\n        })\n      )\n      .subscribe();\n    }catch(error){\n      console.error(JSON.stringify(error));\n      console.error(\"error \");\n      \n    }\n    \n  }\n\n  /**\n   * Redondea un número de bytes a un tamaño legible\n   * @param sizeInBytes Número de bytes\n   */\n  fileSize(sizeInBytes: number) {\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let power = Math.round(Math.log(sizeInBytes) / Math.log(1024));\n    power = Math.min(power, units.length - 1);\n\n    const size = sizeInBytes / Math.pow(1024, power); // size in new units\n    const formattedSize = Math.round(size * 100) / 100; // keep up to 2 decimals\n    const unit = units[power];\n\n    return size ? `${formattedSize} ${unit}` : '0';\n  }\n\n}\n"]}